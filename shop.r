h <- list(
  list(
    name = 'Îãóğöû, êã.',
    min = 100,
    max = 150,
    price = 129
  ),
  list(
    name = 'Ìàéîíåç, óï.',
    min = 80,
    max = 120,
    price = 89
  ),
  list(
    name = 'Ïàñòèëà, øòóê',
    min = 35,
    max = 70,
    price = 39
  ),
  list(
    name = 'Ğàñòâîğèìûé êîôå, óïàêîâîê',
    min = 170,
    max = 200,
    price = 199
  ),
  list(
    name = 'Ğèñ, ïà÷åê',
    min = 100,
    max = 120,
    price = 79
  ),
  list(
    name = 'Îâñÿíêà, ïà÷åê',
    min = 50,
    max = 60,
    price = 89
  ),
  list(
    name = 'Ñãóùåíîå ìîëîêî, áàíîê',
    min = 20,
    max = 30,
    price = 84
  )
)


FILE_SUPPLY <- '.in'
FILE_SALE <- '.out'


generate.data <-
  function(file.name = "Ïåëèêàí",
           path = "C:/Users/tkach/Òêà÷åíêî Íèíà",
           dataType = 'SUPPLY',
           days = 7,
           goods = h) {
    #ïğîâåğêà ñóùåñòâîâàíèÿ ïàïêè
    if (!dir.exists(path)) {
      dir.create(path)
    }
    #ïåğåõîä â ïàïêó
    if (dir.exists(path)) {
      setwd(path) #ïåğåõîä â ïàïêó
      
      #ñîçäàäèì òàáëèöó èç îäíîãî ñòîëáöà äëèíîé days
      tabl <- data.frame('Äåíü' = 1:days)
      #ÏÎÑÒÀÂÊÀ
      if (dataType == 'SUPPLY') {
        for (i in 1:length(goods)) {
          tabl[i + 1] <-
            sample(
              x = goods[[i]]$min:goods[[i]]$max,
              size = days,
              replace = TRUE
            )
          colnames(x = tabl)[i + 1] = unlist(goods[i])[1]
        }
        write.table(
          tabl,
          file = paste0(file.name, FILE_SUPPLY),
          row.names = FALSE,
          sep = ' ',
          #encoding = "UTF-8"
        )
      } else{
        #ÏĞÎÄÀÆÀ
        for (i in 1:length(goods)) {
          data.in <-
            read.table(file = paste0(file.name, FILE_SUPPLY),
                       head = TRUE)
          data.out <- vector()
          for (j in 1:days) {
            data.out[j] <-
              as.integer(runif(
                n = 1,
                min = goods[[i]]$min,
                max = goods[[i]]$max
              ))
            data.out[j] <-
              ifelse(data.out[j] > data.in[j, i + 1],
                     data.in[j, i + 1],
                     data.out[j])
          }
          tabl[i + 1] <- data.out
          colnames(x = tabl)[i + 1] <- unlist(goods[i])['name']
        }
        write.table(
          tabl,
          file = paste0(file.name, FILE_SALE),
          row.names = FALSE,
          sep = ' ',
          #encoding = "UTF-8"
        )
      }
      return(tabl)
    }
  }


h1 <- list(
  list(
    file.name = "Öåíà",
    name = 'Îãóğöû, êã.',
    price_min = 89,
    price_max = 129
  ),
  list(
    file.name = "Öåíà",
    name = 'Ìàéîíåç, óï.',
    price_min = 59,
    price_max = 89
  ),
  list(
    file.name = "Öåíà",
    name = 'Ïàñòèëà, øòóê',
    price_min = 25,
    price_max = 39
  ),
  list(
    file.name = "Öåíà",
    name = 'Ğàñòâîğèìûé êîôå, óïàêîâîê',
    price_min = 149,
    price_max = 199
  ),
  list(
    file.name = "Öåíà",
    name = 'Ğèñ, ïà÷åê',
    price_min = 49,
    price_max = 79
  ),
  list(
    file.name = "Öåíà",
    name = 'Îâñÿíêà, ïà÷åê',
    price_min = 69,
    price_max = 89
  ),
  list(
    file.name = "Öåíà",
    name = 'Ñãóùåíîå ìîëîêî, áàíîê',
    price_min = 70,
    price_max = 84
  )
)


h2 = list(list(name = 'îïòîâàÿ öåíà'),
          list(name = 'öåíà ïğîäàæè'),
          list(name = 'öåíà óòèëèçàöèè'))


generate.price <- function(file.name = "Öåíà",
                           path = "C:/Users/tkach/Òêà÷åíêî Íèíà",
                           days = 7,
                           goods1 = h1,
                           goods2 = h2) {
  #ñîçäàäèì òàáëèöó èç îäíîãî ñòîëáöà äëèíîé day
  tabl1 <- data.frame('Ïğîäóêòû' = 1:7)
  for (i in 1:length(goods1)) {
    tabl1[i, 1] <- goods1[[i]]$name
  }
  
  for (i in 1:days) {
    v <-
      as.integer(runif(
        n = 1,
        min = goods1[[i]]$price_min,
        max = goods1[[i]]$price_max
      ))
    tabl1[i, 2] <- v
  }
  
  colnames(x = tabl1)[2] = goods2[[1]]$name
  for (i in 1:days) {
    tabl1[i, 3] <- tabl1[i, 2] * 1.2
    tabl1[i, 4] <- tabl1[i, 2] * 0.65
  }
  colnames(x = tabl1)[3] = goods2[[2]]$name
  colnames(x = tabl1)[4] = goods2[[3]]$name
  
  write.table(
    tabl1,
    file = paste0(path, '/', file.name, '.txt'),
    row.names = FALSE,
    sep = ' '
  )
  return(tabl1)
}



generate.data(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 1', dataType = 'SUPPLY')
generate.data(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 1', dataType = 'SALE')
generate.data(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 2', dataType = 'SUPPLY')
generate.data(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 2', dataType = 'SALE')
generate.data(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 3', dataType = 'SUPPLY')
generate.data(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 3', dataType = 'SALE')
generate.data(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 4', dataType = 'SUPPLY')
generate.data(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 4', dataType = 'SALE')
generate.data(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 5', dataType = 'SUPPLY')
generate.data(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 5', dataType = 'SALE')
generate.data(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 6', dataType = 'SUPPLY')
generate.data(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 6', dataType = 'SALE')
generate.data(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 7', dataType = 'SUPPLY')
generate.data(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 7', dataType = 'SALE')
generate.data(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 8', dataType = 'SUPPLY')
generate.data(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 8', dataType = 'SALE')
generate.data(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 9', dataType = 'SUPPLY')
generate.data(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 9', dataType = 'SALE')
generate.data(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 10', dataType = 'SUPPLY')
generate.data(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 10', dataType = 'SALE')

generate.price(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 1')
generate.price(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 2')
generate.price(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 3')
generate.price(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 4')
generate.price(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 5')
generate.price(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 6')
generate.price(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 7')
generate.price(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 8')
generate.price(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 9')
generate.price(path = 'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 10')



#ñîçäàíèå òàáëèöû
rev <- rep(0, 12)
profit <- rep(0, length(rev))

res.tab1 <- data.frame(Âûğó÷êà     = rev, "Ïğèáûëü" = profit)
res.tab2 <- data.frame(Âûğó÷êà     = rev, "Ïğèáûëü" = profit)
res.tab3 <- data.frame(Âûğó÷êà     = rev, "Ïğèáûëü" = profit)
res.tab4 <- data.frame(Âûğó÷êà     = rev, "Ïğèáûëü" = profit)
res.tab5 <- data.frame(Âûğó÷êà     = rev, "Ïğèáûëü" = profit)
res.tab6 <- data.frame(Âûğó÷êà     = rev, "Ïğèáûëü" = profit)
res.tab7 <- data.frame(Âûğó÷êà     = rev, "Ïğèáûëü" = profit)



sale1 <- rep(0, nrow(res.tab1))
sale2 <- rep(0, nrow(res.tab2))
sale3 <- rep(0, nrow(res.tab3))
sale4 <- rep(0, nrow(res.tab4))
sale5 <- rep(0, nrow(res.tab5))
sale6 <- rep(0, nrow(res.tab6))
sale7 <- rep(0, nrow(res.tab7))
res.tab1$"Ğåàëèçàöèÿ, êîíò." <- sale1
res.tab1$"Ñïèñàíèå,øò" <- 0
res.tab1$"Ğàâíîìåğíîñòü ïğîäàæ" <- 0
res.tab1$"Ïğîäàæè ìàêñ" <- 0
res.tab1$"Äåíü" <- 0
res.tab1$"Ïğîäàæè ìèí" <- 0
res.tab1$"Äåíü " <- 0
res.tab1$"Ñïèñàíèå ìàêñ" <- 0
res.tab1$" Äåíü" <- 0

res.tab2$"Ğåàëèçàöèÿ, êîíò." <- sale2
res.tab2$"Ñïèñàíèå,øò" <- 0
res.tab2$"Ğàâíîìåğíîñòü ïğîäàæ" <- 0
res.tab2$"Ïğîäàæè ìàêñ" <- 0
res.tab2$"Äåíü" <- 0
res.tab2$"Ïğîäàæè ìèí" <- 0
res.tab2$"Äåíü " <- 0
res.tab2$"Ñïèñàíèå ìàêñ" <- 0
res.tab2$" Äåíü" <- 0

res.tab3$"Ğåàëèçàöèÿ, êîíò." <- sale3
res.tab3$"Ñïèñàíèå,øò" <- 0
res.tab3$"Ğàâíîìåğíîñòü ïğîäàæ" <- 0
res.tab3$"Ïğîäàæè ìàêñ" <- 0
res.tab3$"Äåíü" <- 0
res.tab3$"Ïğîäàæè ìèí" <- 0
res.tab3$"Äåíü " <- 0
res.tab3$"Ñïèñàíèå ìàêñ" <- 0
res.tab3$" Äåíü" <- 0

res.tab4$"Ğåàëèçàöèÿ, êîíò." <- sale4
res.tab4$"Ñïèñàíèå,øò" <- 0
res.tab4$"Ğàâíîìåğíîñòü ïğîäàæ" <- 0
res.tab4$"Ïğîäàæè ìàêñ" <- 0
res.tab4$"Äåíü" <- 0
res.tab4$"Ïğîäàæè ìèí" <- 0
res.tab4$"Äåíü " <- 0
res.tab4$"Ñïèñàíèå ìàêñ" <- 0
res.tab4$" Äåíü" <- 0

res.tab5$"Ğåàëèçàöèÿ, êîíò." <- sale5
res.tab5$"Ñïèñàíèå,øò" <- 0
res.tab5$"Ğàâíîìåğíîñòü ïğîäàæ" <- 0
res.tab5$"Ïğîäàæè ìàêñ" <- 0
res.tab5$"Äåíü" <- 0
res.tab5$"Ïğîäàæè ìèí" <- 0
res.tab5$"Äåíü " <- 0
res.tab5$"Ñïèñàíèå ìàêñ" <- 0
res.tab5$" Äåíü" <- 0

res.tab6$"Ğåàëèçàöèÿ, êîíò." <- sale6
res.tab6$"Ñïèñàíèå,øò" <- 0
res.tab6$"Ğàâíîìåğíîñòü ïğîäàæ" <- 0
res.tab6$"Ïğîäàæè ìàêñ" <- 0
res.tab6$"Äåíü" <- 0
res.tab6$"Ïğîäàæè ìèí" <- 0
res.tab6$"Äåíü " <- 0
res.tab6$"Ñïèñàíèå ìàêñ" <- 0
res.tab6$" Äåíü" <- 0

res.tab7$"Ğåàëèçàöèÿ, êîíò." <- sale7
res.tab7$"Ñïèñàíèå,øò" <- 0
res.tab7$"Ğàâíîìåğíîñòü ïğîäàæ" <- 0
res.tab7$"Ïğîäàæè ìàêñ" <- 0
res.tab7$"Äåíü" <- 0
res.tab7$"Ïğîäàæè ìèí" <- 0
res.tab7$"Äåíü " <- 0
res.tab7$"Ñïèñàíèå ìàêñ" <- 0
res.tab7$" Äåíü" <- 0

res.tab1$"Ìàãàçèí"[1] <- "Ìàãàçèí_1"
res.tab1$"Ìàãàçèí"[2] <- "Ìàãàçèí_2"
res.tab1$"Ìàãàçèí"[3] <- "Ìàãàçèí_3"
res.tab1$"Ìàãàçèí"[4] <- "Ìàãàçèí_4"
res.tab1$"Ìàãàçèí"[5] <- "Ìàãàçèí_5"
res.tab1$"Ìàãàçèí"[6] <- "Ìàãàçèí_6"
res.tab1$"Ìàãàçèí"[7] <- "Ìàãàçèí_7"
res.tab1$"Ìàãàçèí"[8] <- "Ìàãàçèí_8"
res.tab1$"Ìàãàçèí"[9] <- "Ìàãàçèí_9"
res.tab1$"Ìàãàçèí"[10] <- "Ìàãàçèí_10"
res.tab1$"Ìàãàçèí"[11] <- "Èòîãî"
res.tab1$"Ìàãàçèí"[12] <- "Ñğåäíåå"


res.tab2$"Ìàãàçèí"[1] <- "Ìàãàçèí_1"
res.tab2$"Ìàãàçèí"[2] <- "Ìàãàçèí_2"
res.tab2$"Ìàãàçèí"[3] <- "Ìàãàçèí_3"
res.tab2$"Ìàãàçèí"[4] <- "Ìàãàçèí_4"
res.tab2$"Ìàãàçèí"[5] <- "Ìàãàçèí_5"
res.tab2$"Ìàãàçèí"[6] <- "Ìàãàçèí_6"
res.tab2$"Ìàãàçèí"[7] <- "Ìàãàçèí_7"
res.tab2$"Ìàãàçèí"[8] <- "Ìàãàçèí_8"
res.tab2$"Ìàãàçèí"[9] <- "Ìàãàçèí_9"
res.tab2$"Ìàãàçèí"[10] <- "Ìàãàçèí_10"
res.tab2$"Ìàãàçèí"[11] <- "Èòîãî"
res.tab2$"Ìàãàçèí"[12] <- "Ñğåäíåå"

res.tab3$"Ìàãàçèí"[1] <- "Ìàãàçèí_1"
res.tab3$"Ìàãàçèí"[2] <- "Ìàãàçèí_2"
res.tab3$"Ìàãàçèí"[3] <- "Ìàãàçèí_3"
res.tab3$"Ìàãàçèí"[4] <- "Ìàãàçèí_4"
res.tab3$"Ìàãàçèí"[5] <- "Ìàãàçèí_5"
res.tab3$"Ìàãàçèí"[6] <- "Ìàãàçèí_6"
res.tab3$"Ìàãàçèí"[7] <- "Ìàãàçèí_7"
res.tab3$"Ìàãàçèí"[8] <- "Ìàãàçèí_8"
res.tab3$"Ìàãàçèí"[9] <- "Ìàãàçèí_9"
res.tab3$"Ìàãàçèí"[10] <- "Ìàãàçèí_10"
res.tab3$"Ìàãàçèí"[11] <- "Èòîãî"
res.tab3$"Ìàãàçèí"[12] <- "Ñğåäíåå"

res.tab4$"Ìàãàçèí"[1] <- "Ìàãàçèí_1"
res.tab4$"Ìàãàçèí"[2] <- "Ìàãàçèí_2"
res.tab4$"Ìàãàçèí"[3] <- "Ìàãàçèí_3"
res.tab4$"Ìàãàçèí"[4] <- "Ìàãàçèí_4"
res.tab4$"Ìàãàçèí"[5] <- "Ìàãàçèí_5"
res.tab4$"Ìàãàçèí"[6] <- "Ìàãàçèí_6"
res.tab4$"Ìàãàçèí"[7] <- "Ìàãàçèí_7"
res.tab4$"Ìàãàçèí"[8] <- "Ìàãàçèí_8"
res.tab4$"Ìàãàçèí"[9] <- "Ìàãàçèí_9"
res.tab4$"Ìàãàçèí"[10] <- "Ìàãàçèí_10"
res.tab4$"Ìàãàçèí"[11] <- "Èòîãî"
res.tab4$"Ìàãàçèí"[12] <- "Ñğåäíåå"

res.tab5$"Ìàãàçèí"[1] <- "Ìàãàçèí_1"
res.tab5$"Ìàãàçèí"[2] <- "Ìàãàçèí_2"
res.tab5$"Ìàãàçèí"[3] <- "Ìàãàçèí_3"
res.tab5$"Ìàãàçèí"[4] <- "Ìàãàçèí_4"
res.tab5$"Ìàãàçèí"[5] <- "Ìàãàçèí_5"
res.tab5$"Ìàãàçèí"[6] <- "Ìàãàçèí_6"
res.tab5$"Ìàãàçèí"[7] <- "Ìàãàçèí_7"
res.tab5$"Ìàãàçèí"[8] <- "Ìàãàçèí_8"
res.tab5$"Ìàãàçèí"[9] <- "Ìàãàçèí_9"
res.tab5$"Ìàãàçèí"[10] <- "Ìàãàçèí_10"
res.tab5$"Ìàãàçèí"[11] <- "Èòîãî"
res.tab5$"Ìàãàçèí"[12] <- "Ñğåäíåå"

res.tab6$"Ìàãàçèí"[1] <- "Ìàãàçèí_1"
res.tab6$"Ìàãàçèí"[2] <- "Ìàãàçèí_2"
res.tab6$"Ìàãàçèí"[3] <- "Ìàãàçèí_3"
res.tab6$"Ìàãàçèí"[4] <- "Ìàãàçèí_4"
res.tab6$"Ìàãàçèí"[5] <- "Ìàãàçèí_5"
res.tab6$"Ìàãàçèí"[6] <- "Ìàãàçèí_6"
res.tab6$"Ìàãàçèí"[7] <- "Ìàãàçèí_7"
res.tab6$"Ìàãàçèí"[8] <- "Ìàãàçèí_8"
res.tab6$"Ìàãàçèí"[9] <- "Ìàãàçèí_9"
res.tab6$"Ìàãàçèí"[10] <- "Ìàãàçèí_10"
res.tab6$"Ìàãàçèí"[11] <- "Èòîãî"
res.tab6$"Ìàãàçèí"[12] <- "Ñğåäíåå"

res.tab7$"Ìàãàçèí"[1] <- "Ìàãàçèí_1"
res.tab7$"Ìàãàçèí"[2] <- "Ìàãàçèí_2"
res.tab7$"Ìàãàçèí"[3] <- "Ìàãàçèí_3"
res.tab7$"Ìàãàçèí"[4] <- "Ìàãàçèí_4"
res.tab7$"Ìàãàçèí"[5] <- "Ìàãàçèí_5"
res.tab7$"Ìàãàçèí"[6] <- "Ìàãàçèí_6"
res.tab7$"Ìàãàçèí"[7] <- "Ìàãàçèí_7"
res.tab7$"Ìàãàçèí"[8] <- "Ìàãàçèí_8"
res.tab7$"Ìàãàçèí"[9] <- "Ìàãàçèí_9"
res.tab7$"Ìàãàçèí"[10] <- "Ìàãàçèí_10"
res.tab7$"Ìàãàçèí"[11] <- "Èòîãî"
res.tab7$"Ìàãàçèí"[12] <- "Ñğåäíåå"



p <-
  c(
    'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 1',
    'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 2',
    'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 3',
    'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 4',
    'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 5',
    'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 6',
    'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 7',
    'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 8',
    'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 9',
    'C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 10'
  )
sum_out1 <- vector()
sum_out2 <- vector()
sum_out3 <- vector()
sum_out4 <- vector()
sum_out5 <- vector()
sum_out6 <- vector()
sum_out7 <- vector()
sum_in1 <- vector()
sum_in2 <- vector()
sum_in3 <- vector()
sum_in4 <- vector()
sum_in5 <- vector()
sum_in6 <- vector()
sum_in7 <- vector()


for (i in 1:10) {
  #ñ÷èòûâàíèå èñõîäíûõ äàííûõ â ïåğåìåííûå
  setwd(p[i])
  in1 <- read.table("Ïåëèêàí.in", head = TRUE, encoding = "UTF-8")
  out1 <- read.table("Ïåëèêàí.out", head = TRUE, encoding = "UTF-8")
  price <-
    read.table("Öåíà.txt", head = TRUE, encoding = "UTF-8")
  sum_out1 <- c(sum_out1, sum(out1[2]))
  sum_out2 <- c(sum_out2, sum(out1[3]))
  sum_out3 <- c(sum_out3, sum(out1[4]))
  sum_out4 <- c(sum_out4, sum(out1[5]))
  sum_out5 <- c(sum_out5, sum(out1[6]))
  sum_out6 <- c(sum_out6, sum(out1[7]))
  sum_out7 <- c(sum_out7, sum(out1[8]))
  sum_in1 <- c(sum_in1, sum(in1[2]))
  sum_in2 <- c(sum_in2, sum(in1[3]))
  sum_in3 <- c(sum_in3, sum(in1[4]))
  sum_in4 <- c(sum_in4, sum(in1[5]))
  sum_in5 <- c(sum_in5, sum(in1[6]))
  sum_in6 <- c(sum_in6, sum(in1[7]))
  sum_in7 <- c(sum_in7, sum(in1[8]))
  #Âûğó÷êà ÑÊÎÏÈĞÎÂÀÒÜ ÄËß ÎÑÒÀËÜÍÛÕ ÌÀÃÀÇÈÍÎÂ
  setwd('C:/Users/tkach/Òêà÷åíêî Íèíà/Àíàëèç')
  #____________1_______________
  p_supply <- price[1 , 2] #öåíà çàêóïêè
  p_sale <- price[1 , 3] #öåíà ïğîäàæè
  p_util <- price[1 , 4] #öåíà óòèëèçàöèè
  Q_supply = sum_in1[i] #SUM_IN2...
  sales = sum_out1[i]#SUM_out2...
  Q_util = Q_supply - sales
  
  TC = Q_supply * p_supply + Q_util * p_util #
  res.tab1[i, 1] = sales * p_sale#
  res.tab1[i, 2] = res.tab1[i, 1] - TC#ïğèáûëü
  res.tab1[i, 3] = sales#
  res.tab1[i, 4] = Q_util#
  
  res.tab1$"Âûğó÷êà"[11] <- sum(res.tab1$"Âûğó÷êà"[1:10])#
  res.tab1$"Âûğó÷êà"[12] <- mean(res.tab1$"Âûğó÷êà"[1:10])#
  res.tab1$"Ïğèáûëü"[11] <- sum(res.tab1$"Ïğèáûëü"[1:10])#
  res.tab1$"Ïğèáûëü"[12] <- mean(res.tab1$"Ïğèáûëü"[1:10])#
  
  
  res.tab1$"Ğàâíîìåğíîñòü ïğîäàæ"[i] <-
    round(sd(out1[1:7, 2]), 2) #[1:7,3]
  
  res.tab1$"Ğàâíîìåğíîñòü ïğîäàæ"[11] <- #
    sum(res.tab1$"Ğàâíîìåğíîñòü ïğîäàæ"[1:10])#
  res.tab1$"Ğàâíîìåğíîñòü ïğîäàæ"[12] <- #
    mean(res.tab1$"Ğàâíîìåğíîñòü ïğîäàæ"[1:10])#
  res.tab1$"Ğåàëèçàöèÿ, êîíò."[i] <- sum_in1[i]#
  res.tab1$"Ñïèñàíèå,øò"[i] <- sum_in1[i] - sum_out1[i]#
  res.tab1$"Ğåàëèçàöèÿ, êîíò."[11] <- #
    sum(res.tab1$"Ğåàëèçàöèÿ, êîíò."[1:10])#
  res.tab1$"Ğåàëèçàöèÿ, êîíò."[12] <- #
    mean(res.tab1$"Ğåàëèçàöèÿ, êîíò."[1:10])#
  
  res.tab1$"Ñïèñàíèå,øò"[11] <- sum(res.tab1$"Ñïèñàíèå,øò"[1:10])#
  res.tab1$"Ñïèñàíèå,øò"[12] <- mean(res.tab1$"Ñïèñàíèå,øò"[1:10])#
  
  sp1 <-
    c((in1[1, 2] - out1[1, 2]),
      (in1[2, 2] - out1[2, 2]),
      (in1[3, 2] - out1[3, 2]) ,
      (in1[4, 2] - out1[4, 2]),
      (in1[5, 2] - out1[5, 2]),
      (in1[6, 2] - out1[6, 2]),
      (in1[7, 2] - out1[7, 2])
    ) #ìåíÿòü íà [1,3]...[7,3], [1,4]...[7..4]
  res.tab1$"Ïğîäàæè ìàêñ"[i] <- max(out1[2]) #out1[3] out1[4]
  res.tab1$"Äåíü"[i] <- which.max(out1[1:7, 2]) #out1[3] out1[4]
  res.tab1$"Ïğîäàæè ìèí"[i] <- min(out1[2]) #out1[3] out1[4]
  res.tab1$"Äåíü "[i] <- which.min(out1[1:7, 2]) #out1[3] out1[4]
  res.tab1$"Ñïèñàíèå ìàêñ"[i] <- max(sp1)#
  res.tab1$" Äåíü"[i] <- which.max(sp1)#
  for (j in 11:12) {
    #
    res.tab1$"Ïğîäàæè ìàêñ"[j] <- ' ' #
    res.tab1$"Äåíü"[j] <- '' #
    res.tab1$"Ïğîäàæè ìèí"[j] <- ' ' #
    res.tab1$"Äåíü "[j] <- ' ' #
    res.tab1$"Ñïèñàíèå ìàêñ"[j] <- ' ' #
    res.tab1$" Äåíü"[j] <- ' ' #
    write.table(
      res.tab1,
      file = paste0(h[[1]]$name, '.txt'),
      # h[[2]]
      row.names = FALSE,
      sep = ' ',
      #encoding = "UTF-8"
    )
  }
  
  #____________2_______________
  p_supply <- price[2 , 2] #öåíà çàêóïêè
  p_sale <- price[2 , 3] #öåíà ïğîäàæè
  p_util <- price[2 , 4] #öåíà óòèëèçàöèè
  Q_supply = sum_in2[i] #SUM_IN2...
  sales = sum_out2[i]#SUM_out2...
  Q_util = Q_supply - sales
  
  TC = Q_supply * p_supply + Q_util * p_util #
  res.tab2[i, 1] = sales * p_sale#
  res.tab2[i, 2] = res.tab2[i, 1] - TC#
  res.tab2[i, 3] = sales#
  res.tab2[i, 4] = Q_util#
  
  res.tab2$"Âûğó÷êà"[11] <- sum(res.tab2$"Âûğó÷êà"[1:10])#
  res.tab2$"Âûğó÷êà"[12] <- mean(res.tab2$"Âûğó÷êà"[1:10])#
  res.tab2$"Ïğèáûëü"[11] <- sum(res.tab2$"Ïğèáûëü"[1:10])#
  res.tab2$"Ïğèáûëü"[12] <- mean(res.tab2$"Ïğèáûëü"[1:10])#
  
  
  res.tab2$"Ğàâíîìåğíîñòü ïğîäàæ"[i] <-
    round(sd(out1[1:7, 3]), 2) #[1:7,3]
  
  res.tab2$"Ğàâíîìåğíîñòü ïğîäàæ"[11] <- #
    sum(res.tab2$"Ğàâíîìåğíîñòü ïğîäàæ"[1:10])#
  res.tab2$"Ğàâíîìåğíîñòü ïğîäàæ"[12] <- #
    mean(res.tab2$"Ğàâíîìåğíîñòü ïğîäàæ"[1:10])#
  res.tab2$"Ğåàëèçàöèÿ, êîíò."[i] <- sum_in2[i]##SUM_IN2...
  res.tab2$"Ñïèñàíèå,øò"[i] <-
    sum_in2[i] - sum_out2[i]##SUM_IN2...
  res.tab2$"Ğåàëèçàöèÿ, êîíò."[11] <- #
    sum(res.tab2$"Ğåàëèçàöèÿ, êîíò."[1:10])#
  res.tab2$"Ğåàëèçàöèÿ, êîíò."[12] <- #
    mean(res.tab2$"Ğåàëèçàöèÿ, êîíò."[1:10])#
  
  res.tab2$"Ñïèñàíèå,øò"[11] <- sum(res.tab2$"Ñïèñàíèå,øò"[1:10])#
  res.tab2$"Ñïèñàíèå,øò"[12] <-
    mean(res.tab2$"Ñïèñàíèå,øò"[1:10])#
  
  sp1 <-
    c((in1[1, 3] - out1[1, 3]),
      (in1[2, 3] - out1[2, 3]),
      (in1[3, 3] - out1[3, 3]) ,
      (in1[4, 3] - out1[4, 3]),
      (in1[5, 3] - out1[5, 3]),
      (in1[6, 3] - out1[6, 3]),
      (in1[7, 3] - out1[7, 3])
    ) #ìåíÿòü íà [1,3]...[7,3], [1,4]...[7..4]
  res.tab2$"Ïğîäàæè ìàêñ"[i] <- max(out1[3]) #out1[3] out1[4]
  res.tab2$"Äåíü"[i] <- which.max(out1[1:7, 3]) #out1[3] out1[4]
  res.tab2$"Ïğîäàæè ìèí"[i] <- min(out1[3]) #out1[3] out1[4]
  res.tab2$"Äåíü "[i] <- which.min(out1[1:7, 3]) #out1[3] out1[4]
  res.tab2$"Ñïèñàíèå ìàêñ"[i] <- max(sp1)#
  res.tab2$" Äåíü"[i] <- which.max(sp1)#
  
  write.table(
    res.tab2,
    file = paste0(h[[2]]$name, '.txt'),
    # h[[2]]
    row.names = FALSE,
    sep = ' ',
    
  )
  
  
  #____________3_______________
  p_supply <- price[3 , 2] #öåíà çàêóïêè
  p_sale <- price[3 , 3] #öåíà ïğîäàæè
  p_util <- price[3 , 4] #öåíà óòèëèçàöèè
  Q_supply = sum_in3[i] #SUM_IN2...
  sales = sum_out3[i]#SUM_out2...
  Q_util = Q_supply - sales
  
  TC = Q_supply * p_supply + Q_util * p_util #
  res.tab3[i, 1] = sales * p_sale#
  res.tab3[i, 2] = res.tab3[i, 1] - TC#
  res.tab3[i, 3] = sales#
  res.tab3[i, 4] = Q_util#
  
  res.tab3$"Âûğó÷êà"[11] <- sum(res.tab3$"Âûğó÷êà"[1:10])#
  res.tab3$"Âûğó÷êà"[12] <- mean(res.tab3$"Âûğó÷êà"[1:10])#
  res.tab3$"Ïğèáûëü"[11] <- sum(res.tab3$"Ïğèáûëü"[1:10])#
  res.tab3$"Ïğèáûëü"[12] <- mean(res.tab3$"Ïğèáûëü"[1:10])#
  
  
  res.tab3$"Ğàâíîìåğíîñòü ïğîäàæ"[i] <-
    round(sd(out1[1:7, 4]), 2) #[1:7,3]
  
  res.tab3$"Ğàâíîìåğíîñòü ïğîäàæ"[11] <- #
    sum(res.tab3$"Ğàâíîìåğíîñòü ïğîäàæ"[1:10])#
  res.tab3$"Ğàâíîìåğíîñòü ïğîäàæ"[12] <- #
    mean(res.tab3$"Ğàâíîìåğíîñòü ïğîäàæ"[1:10])#
  res.tab3$"Ğåàëèçàöèÿ, êîíò."[i] <- sum_in3[i]#SUM_IN2...
  res.tab3$"Ñïèñàíèå,øò"[i] <-
    sum_in3[i] - sum_out3[i]##SUM_IN2...
  res.tab3$"Ğåàëèçàöèÿ, êîíò."[11] <- #
    sum(res.tab3$"Ğåàëèçàöèÿ, êîíò."[1:10])#
  res.tab3$"Ğåàëèçàöèÿ, êîíò."[12] <- #
    mean(res.tab3$"Ğåàëèçàöèÿ, êîíò."[1:10])#
  
  res.tab3$"Ñïèñàíèå,øò"[11] <- sum(res.tab3$"Ñïèñàíèå,øò"[1:10])#
  res.tab3$"Ñïèñàíèå,øò"[12] <-
    mean(res.tab3$"Ñïèñàíèå,øò"[1:10])#
  
  sp1 <-
    c((in1[1, 4] - out1[1, 4]),
      (in1[2, 4] - out1[2, 4]),
      (in1[3, 4] - out1[3, 4]) ,
      (in1[4, 4] - out1[4, 4]),
      (in1[5, 4] - out1[5, 4]),
      (in1[6, 4] - out1[6, 4]),
      (in1[7, 4] - out1[7, 4])
    ) #ìåíÿòü íà [1,3]...[7,3], [1,4]...[7..4]
  res.tab3$"Ïğîäàæè ìàêñ"[i] <- max(out1[4]) #out1[3] out1[4]
  res.tab3$"Äåíü"[i] <- which.max(out1[1:7, 4]) #out1[3] out1[4]
  res.tab3$"Ïğîäàæè ìèí"[i] <- min(out1[4]) #out1[3] out1[4]
  res.tab3$"Äåíü "[i] <- which.min(out1[1:7, 4]) #out1[3] out1[4]
  res.tab3$"Ñïèñàíèå ìàêñ"[i] <- max(sp1)#
  res.tab3$" Äåíü"[i] <- which.max(sp1)#
  
  
  write.table(
    res.tab3,
    file = paste0(h[[3]]$name, '.txt'),
    # h[[2]]
    row.names = FALSE,
    sep = ' ',
  )
  #____________4_______________
  p_supply <- price[4 , 2] #öåíà çàêóïêè
  p_sale <- price[4 , 3] #öåíà ïğîäàæè
  p_util <- price[4 , 4] #öåíà óòèëèçàöèè
  Q_supply = sum_in4[i] #SUM_IN2...
  sales = sum_out4[i]#SUM_out2...
  Q_util = Q_supply - sales
  
  TC = Q_supply * p_supply + Q_util * p_util #
  res.tab4[i, 1] = sales * p_sale#
  res.tab4[i, 2] = res.tab4[i, 1] - TC#
  res.tab4[i, 3] = sales#
  res.tab4[i, 4] = Q_util#
  
  res.tab4$"Âûğó÷êà"[11] <- sum(res.tab4$"Âûğó÷êà"[1:10])#
  res.tab4$"Âûğó÷êà"[12] <- mean(res.tab4$"Âûğó÷êà"[1:10])#
  res.tab4$"Ïğèáûëü"[11] <- sum(res.tab4$"Ïğèáûëü"[1:10])#
  res.tab4$"Ïğèáûëü"[12] <- mean(res.tab4$"Ïğèáûëü"[1:10])#
  
  
  res.tab4$"Ğàâíîìåğíîñòü ïğîäàæ"[i] <-
    round(sd(out1[1:7, 5]), 2) #[1:7,3]
  
  res.tab4$"Ğàâíîìåğíîñòü ïğîäàæ"[11] <- #
    sum(res.tab4$"Ğàâíîìåğíîñòü ïğîäàæ"[1:10])#
  res.tab4$"Ğàâíîìåğíîñòü ïğîäàæ"[12] <- #
    mean(res.tab4$"Ğàâíîìåğíîñòü ïğîäàæ"[1:10])#
  res.tab4$"Ğåàëèçàöèÿ, êîíò."[i] <- sum_in4[i]#SUM_IN2...
  res.tab4$"Ñïèñàíèå,øò"[i] <- sum_in4[i] - sum_out4[i]##SUM_IN2...
  res.tab4$"Ğåàëèçàöèÿ, êîíò."[11] <- #
    sum(res.tab4$"Ğåàëèçàöèÿ, êîíò."[1:10])#
  res.tab4$"Ğåàëèçàöèÿ, êîíò."[12] <- #
    mean(res.tab4$"Ğåàëèçàöèÿ, êîíò."[1:10])#
  
  res.tab4$"Ñïèñàíèå,øò"[11] <- sum(res.tab4$"Ñïèñàíèå,øò"[1:10])#
  res.tab4$"Ñïèñàíèå,øò"[12] <- mean(res.tab4$"Ñïèñàíèå,øò"[1:10])#
  
  sp1 <-
    c((in1[1, 5] - out1[1, 5]),
      (in1[2, 5] - out1[2, 5]),
      (in1[3, 5] - out1[3, 5]) ,
      (in1[4, 5] - out1[4, 5]),
      (in1[5, 5] - out1[5, 5]),
      (in1[6, 5] - out1[6, 5]),
      (in1[7, 5] - out1[7, 5])
    ) #ìåíÿòü íà [1,3]...[7,3], [1,4]...[7..4]
  res.tab4$"Ïğîäàæè ìàêñ"[i] <- max(out1[5]) #out1[3] out1[4]
  res.tab4$"Äåíü"[i] <- which.max(out1[1:7, 5]) #out1[3] out1[4]
  res.tab4$"Ïğîäàæè ìèí"[i] <- min(out1[5]) #out1[3] out1[4]
  res.tab4$"Äåíü "[i] <- which.min(out1[1:7, 5]) #out1[3] out1[4]
  res.tab4$"Ñïèñàíèå ìàêñ"[i] <- max(sp1)#
  res.tab4$" Äåíü"[i] <- which.max(sp1)#
  
  
  write.table(
    res.tab4,
    file = paste0(h[[4]]$name, '.txt'),
    # h[[2]]
    row.names = FALSE,
    sep = ' ',
  )
  #____________5_______________
  p_supply <- price[5 , 2] #öåíà çàêóïêè
  p_sale <- price[5 , 3] #öåíà ïğîäàæè
  p_util <- price[5 , 4] #öåíà óòèëèçàöèè
  Q_supply = sum_in5[i] #SUM_IN2...
  sales = sum_out5[i]#SUM_out2...
  Q_util = Q_supply - sales
  
  TC = Q_supply * p_supply + Q_util * p_util #
  res.tab5[i, 1] = sales * p_sale#
  res.tab5[i, 2] = res.tab5[i, 1] - TC#
  res.tab5[i, 3] = sales#
  res.tab5[i, 4] = Q_util#
  
  res.tab5$"Âûğó÷êà"[11] <- sum(res.tab5$"Âûğó÷êà"[1:10])#
  res.tab5$"Âûğó÷êà"[12] <- mean(res.tab5$"Âûğó÷êà"[1:10])#
  res.tab5$"Ïğèáûëü"[11] <- sum(res.tab5$"Ïğèáûëü"[1:10])#
  res.tab5$"Ïğèáûëü"[12] <- mean(res.tab5$"Ïğèáûëü"[1:10])#
  
  
  res.tab5$"Ğàâíîìåğíîñòü ïğîäàæ"[i] <-
    round(sd(out1[1:7, 6]), 2) #[1:7,3]
  
  res.tab5$"Ğàâíîìåğíîñòü ïğîäàæ"[11] <- #
    sum(res.tab5$"Ğàâíîìåğíîñòü ïğîäàæ"[1:10])#
  res.tab5$"Ğàâíîìåğíîñòü ïğîäàæ"[12] <- #
    mean(res.tab5$"Ğàâíîìåğíîñòü ïğîäàæ"[1:10])#
  res.tab5$"Ğåàëèçàöèÿ, êîíò."[i] <- sum_in5[i]#SUM_IN2...
  res.tab5$"Ñïèñàíèå,øò"[i] <- sum_in5[i] - sum_out5[i]##SUM_IN2...
  res.tab5$"Ğåàëèçàöèÿ, êîíò."[11] <- #
    sum(res.tab5$"Ğåàëèçàöèÿ, êîíò."[1:10])#
  res.tab5$"Ğåàëèçàöèÿ, êîíò."[12] <- #
    mean(res.tab5$"Ğåàëèçàöèÿ, êîíò."[1:10])#
  
  res.tab5$"Ñïèñàíèå,øò"[11] <- sum(res.tab5$"Ñïèñàíèå,øò"[1:10])#
  res.tab5$"Ñïèñàíèå,øò"[12] <- mean(res.tab5$"Ñïèñàíèå,øò"[1:10])#
  
  sp1 <-
    c((in1[1, 6] - out1[1, 6]),
      (in1[2, 6] - out1[2, 6]),
      (in1[3, 6] - out1[3, 6]) ,
      (in1[4, 6] - out1[4, 6]),
      (in1[5, 6] - out1[5, 6]),
      (in1[6, 6] - out1[6, 6]),
      (in1[7, 6] - out1[7, 6])
    ) #ìåíÿòü íà [1,3]...[7,3], [1,4]...[7..4]
  res.tab5$"Ïğîäàæè ìàêñ"[i] <- max(out1[6]) #out1[3] out1[4]
  res.tab5$"Äåíü"[i] <- which.max(out1[1:7, 6]) #out1[3] out1[4]
  res.tab5$"Ïğîäàæè ìèí"[i] <- min(out1[6]) #out1[3] out1[4]
  res.tab5$"Äåíü "[i] <- which.min(out1[1:7, 6]) #out1[3] out1[4]
  res.tab5$"Ñïèñàíèå ìàêñ"[i] <- max(sp1)#
  res.tab5$" Äåíü"[i] <- which.max(sp1)#
  
  
  write.table(
    res.tab5,
    file = paste0(h[[5]]$name, '.txt'),
    # h[[2]]
    row.names = FALSE,
    sep = ' ',
  )
  
  #____________6_______________
  p_supply <- price[6 , 2] #öåíà çàêóïêè
  p_sale <- price[6 , 3] #öåíà ïğîäàæè
  p_util <- price[6 , 4] #öåíà óòèëèçàöèè
  Q_supply = sum_in6[i]
  sales = sum_out6[i]
  Q_util = Q_supply - sales
  
  TC = Q_supply * p_supply + Q_util * p_util
  res.tab6[i, 1] = sales * p_sale
  res.tab6[i, 2] = res.tab6[i, 1] - TC
  res.tab6[i, 3] = sales
  res.tab6[i, 4] = Q_util
  
  res.tab6$"Âûğó÷êà"[11] <- sum(res.tab6$"Âûğó÷êà"[1:10])
  res.tab6$"Âûğó÷êà"[12] <- mean(res.tab6$"Âûğó÷êà"[1:10])
  res.tab6$"Ïğèáûëü"[11] <- sum(res.tab6$"Ïğèáûëü"[1:10])
  res.tab6$"Ïğèáûëü"[12] <- mean(res.tab6$"Ïğèáûëü"[1:10])
  
  
  res.tab6$"Ğàâíîìåğíîñòü ïğîäàæ"[i] <-
    round(sd(out1[1:7, 7]), 2)
  
  res.tab6$"Ğàâíîìåğíîñòü ïğîäàæ"[11] <-
    sum(res.tab6$"Ğàâíîìåğíîñòü ïğîäàæ"[1:10])
  res.tab6$"Ğàâíîìåğíîñòü ïğîäàæ"[12] <-
    mean(res.tab6$"Ğàâíîìåğíîñòü ïğîäàæ"[1:10])
  res.tab6$"Ğåàëèçàöèÿ, êîíò."[i] <- sum_in6[i]
  res.tab6$"Ñïèñàíèå,øò"[i] <- sum_in6[i] - sum_out6[i]
  res.tab6$"Ğåàëèçàöèÿ, êîíò."[11] <-
    sum(res.tab6$"Ğåàëèçàöèÿ, êîíò."[1:10])
  res.tab6$"Ğåàëèçàöèÿ, êîíò."[12] <-
    mean(res.tab6$"Ğåàëèçàöèÿ, êîíò."[1:10])
  
  res.tab6$"Ñïèñàíèå,øò"[11] <- sum(res.tab6$"Ñïèñàíèå,øò"[1:10])
  res.tab6$"Ñïèñàíèå,øò"[12] <- mean(res.tab6$"Ñïèñàíèå,øò"[1:10])
  
  sp1 <-
    c((in1[1, 7] - out1[1, 7]),
      (in1[2, 7] - out1[2, 7]),
      (in1[3, 7] - out1[3, 7]) ,
      (in1[4, 7] - out1[4, 7]),
      (in1[5, 7] - out1[5, 7]),
      (in1[6, 7] - out1[6, 7]),
      (in1[7, 7] - out1[7, 7])
    )
  res.tab6$"Ïğîäàæè ìàêñ"[i] <- max(out1[7])
  res.tab6$"Äåíü"[i] <- which.max(out1[1:7, 7])
  res.tab6$"Ïğîäàæè ìèí"[i] <- min(out1[7])
  res.tab6$"Äåíü "[i] <- which.min(out1[1:7, 7])
  res.tab6$"Ñïèñàíèå ìàêñ"[i] <- max(sp1)
  res.tab6$" Äåíü"[i] <- which.max(sp1)
  
  
  write.table(
    res.tab6,
    file = paste0(h[[6]]$name, '.txt'),
    # h[[2]]
    row.names = FALSE,
    sep = ' ',
  )
  
  #____________7_______________
  p_supply <- price[7 , 2] #öåíà çàêóïêè
  p_sale <- price[7 , 3] #öåíà ïğîäàæè
  p_util <- price[7 , 4] #öåíà óòèëèçàöèè
  Q_supply = sum_in7[i] #SUM_IN2...
  sales = sum_out7[i]#SUM_out2...
  Q_util = Q_supply - sales
  
  TC = Q_supply * p_supply + Q_util * p_util
  res.tab7[i, 1] = sales * p_sale
  res.tab7[i, 2] = res.tab7[i, 1] - TC
  res.tab7[i, 3] = sales
  res.tab7[i, 4] = Q_util
  
  res.tab7$"Âûğó÷êà"[11] <- sum(res.tab7$"Âûğó÷êà"[1:10])
  res.tab7$"Âûğó÷êà"[12] <- mean(res.tab7$"Âûğó÷êà"[1:10])
  res.tab7$"Ïğèáûëü"[11] <- sum(res.tab7$"Ïğèáûëü"[1:10])
  res.tab7$"Ïğèáûëü"[12] <- mean(res.tab7$"Ïğèáûëü"[1:10])
  
  
  res.tab7$"Ğàâíîìåğíîñòü ïğîäàæ"[i] <-
    round(sd(out1[1:7, 8]), 2)
  
  res.tab7$"Ğàâíîìåğíîñòü ïğîäàæ"[11] <-
    sum(res.tab7$"Ğàâíîìåğíîñòü ïğîäàæ"[1:10])
  res.tab7$"Ğàâíîìåğíîñòü ïğîäàæ"[12] <-
    mean(res.tab7$"Ğàâíîìåğíîñòü ïğîäàæ"[1:10])
  res.tab7$"Ğåàëèçàöèÿ, êîíò."[i] <- sum_in7[i]
  res.tab7$"Ñïèñàíèå,øò"[i] <- sum_in7[i] - sum_out7[i]
  res.tab7$"Ğåàëèçàöèÿ, êîíò."[11] <-
    sum(res.tab7$"Ğåàëèçàöèÿ, êîíò."[1:10])
  res.tab7$"Ğåàëèçàöèÿ, êîíò."[12] <-
    mean(res.tab7$"Ğåàëèçàöèÿ, êîíò."[1:10])
  
  res.tab7$"Ñïèñàíèå,øò"[11] <- sum(res.tab7$"Ñïèñàíèå,øò"[1:10])
  res.tab7$"Ñïèñàíèå,øò"[12] <- mean(res.tab7$"Ñïèñàíèå,øò"[1:10])
  
  sp1 <-
    c((in1[1, 8] - out1[1, 8]),
      (in1[2, 8] - out1[2, 8]),
      (in1[3, 8] - out1[3, 8]) ,
      (in1[4, 8] - out1[4, 8]),
      (in1[5, 8] - out1[5, 8]),
      (in1[6, 8] - out1[6, 8]),
      (in1[7, 8] - out1[7, 8])
    )
  res.tab7$"Ïğîäàæè ìàêñ"[i] <- max(out1[8])
  res.tab7$"Äåíü"[i] <- which.max(out1[1:7, 8])
  res.tab7$"Ïğîäàæè ìèí"[i] <- min(out1[8])
  res.tab7$"Äåíü "[i] <- which.min(out1[1:7, 8])
  res.tab7$"Ñïèñàíèå ìàêñ"[i] <- max(sp1)
  res.tab7$" Äåíü"[i] <- which.max(sp1)
  
  
  write.table(
    res.tab7,
    file = paste0(h[[7]]$name, '.txt'),
    row.names = FALSE,
    sep = ' ',
  )
}



#ãğàôèêè
#1.1
{
  setwd('C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 1')
  in1 <- read.table("Ïåëèêàí.in", head = TRUE, encoding = "UTF-8")
  out1 <- read.table("Ïåëèêàí.out", head = TRUE, encoding = "UTF-8")
  data <- out1[1:7, 2]
  dev.new()
  plot(
    x = data,
    type = 'b',
    main = 'Ïğîäàæà îãóğöîâ ïî äíÿì íåäåëè â ïåğâîì ìàãàçèíå',
    xlab = 'Äåíü íåäåëè',
    ylab = "Îãóğöû, êã.",
    col = 'blue',
    lwd = 2
  )
}
#2.1

#2.1
{
  setwd('C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 2')
  price <- read.table("Öåíà.txt", head = TRUE, encoding = "UTF-8")
  out2 <- read.table("Ïåëèêàí.out", head = TRUE, encoding = "UTF-8")
  data1 <- out2[1:7, 2] * price[1, 3]
  data2 <- out2[1:7, 3] * price[2, 3]
  data3 <- out2[1:7, 4] * price[3, 3]
  dev.new()
  plot(
    x = data1,
    col = 'orange',
    type = 'b',
    fg = 'black',
    lwd = 2,
    main = 'Äèíàìèêà ïğîäàæ òîâàğîâ âî âòîğîì ìàãàçèíå',
    xlab = 'Äåíü íåäåëè',
    ylab = 'Âûğó÷êà ïî òîâàğó, ğóá.',
    ylim = c(0, max(data1, data2, data3))
  )
  
  lines(x = data2, col = 'green')
  points(x = data2, col = 'green', pch = 20)
  
  lines(x = data3, col = 'blue')
  points(x = data3, col = 'blue', pch = 20)
  
  
  legend(
    'topleft',
    legend = c('Îãóğöû', 'Ìàéîíåç', 'Ïàñòèëà'),
    col = c('orange', 'green', 'blue'),
    pch = 20,
    cex = 0.75,
  )
}

#2.2
{
  setwd('C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 3')
  price <- read.table("Öåíà.txt", head = TRUE, encoding = "UTF-8")
  out3 <- read.table("Ïåëèêàí.out", head = TRUE, encoding = "UTF-8")
  data1 <- out3[1:7, 2] * price[1, 3]
  data2 <- out3[1:7, 3] * price[2, 3]
  data3 <- out3[1:7, 4] * price[3, 3]
  dev.new()
  plot(
    x = data1,
    col = 'orange',
    type = 'b',
    fg = 'black',
    lwd = 2,
    main = 'Äèíàìèêà ïğîäàæ òîâàğîâ â òğåòüåì ìàãàçèíå',
    xlab = 'Äåíü íåäåëè',
    ylab = 'Âûğó÷êà ïî òîâàğó, ğóá.',
    ylim = c(0, max(data1, data2, data3))
  )
  
  lines(x = data2, col = 'green')
  points(x = data2, col = 'green', pch = 20)
  
  lines(x = data3, col = 'blue')
  points(x = data3, col = 'blue', pch = 20)
  
  
  legend(
    'topleft',
    legend = c('Îãóğöû', 'Ìàéîíåç', 'Ïàñòèëà'),
    col = c('orange', 'green', 'blue'),
    pch = 20,
    cex = 0.75,
  )
}

#3.1
{
  setwd('C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 2')
  in1 <-
    out1 <- read.table("Ïåëèêàí.in", head = TRUE, encoding = "UTF-8")
  out1 <- read.table("Ïåëèêàí.out", head = TRUE, encoding = "UTF-8")
  sale <- read.table("Öåíà.txt", head = TRUE, encoding = "UTF-8")
  Pr1 <- vector()
  Pr2 <- vector()
  Pr3 <- vector()
  for (i in 1:7) {
    a <-
      (out1[i, 5] * sale[4, 3] - in1[i, 5] * sale[4, 2] - sale[4, 4] * (in1[i, 5] - out1[i, 5]))
    Pr1 <- c(Pr1, a)
    b <-
      (out1[i, 6] * sale[4, 3] - in1[i, 6] * sale[5, 2] - sale[5, 4] * (in1[i, 6] - out1[i, 6]))
    Pr2 <- c(Pr2, b)
    c <-
      (out1[i, 8] * sale[7, 3] - in1[i, 8] * sale[7, 2] - sale[5, 4] * (in1[i, 8] - out1[i, 8]))
    Pr3 <- c(Pr3, c)
  }
  dev.new()
  plot(
    x = Pr1,
    col = 'orange',
    type = 'b',
    fg = 'black',
    lwd = 2,
    main = 'Äèíàìèêà ïğèáûëè òîâàğîâ âî âòîğîì ìàãàçèíå',
    xlab = 'Äåíü íåäåëè',
    ylab = 'Ïğèáûëü ïî òîâàğó, ğóá.',
    ylim = c(min(Pr1, Pr2, Pr3), max(Pr1, Pr2, Pr3))
  )
  
  lines(x = Pr2, col = 'green')
  points(x = Pr2, col = 'green', pch = 20)
  
  lines(x = Pr3, col = 'blue')
  points(x = Pr3, col = 'blue', pch = 20)
  
  
  legend(
    'topleft',
    legend = c('Ğàñòâîğèìûé êîôå', 'Ğèñ', 'Ñãóùåíîå ìîëîêî'),
    col = c('orange', 'green', 'blue'),
    pch = 20,
    cex = 0.75,
  )
}

#3.2
{
  setwd('C:/Users/tkach/Òêà÷åíêî Íèíà/Ìàãàçèí 3')
  in1 <-
    out1 <- read.table("Ïåëèêàí.in", head = TRUE, encoding = "UTF-8")
  out1 <- read.table("Ïåëèêàí.out", head = TRUE, encoding = "UTF-8")
  sale <- read.table("Öåíà.txt", head = TRUE, encoding = "UTF-8")
  Pr1 <- vector()
  Pr2 <- vector()
  Pr3 <- vector()
  for (i in 1:7) {
    a <-
      (out1[i, 5] * sale[4, 3] - in1[i, 5] * sale[4, 2] - sale[4, 4] * (in1[i, 5] - out1[i, 5]))
    Pr1 <- c(Pr1, a)
    b <-
      (out1[i, 6] * sale[4, 3] - in1[i, 6] * sale[5, 2] - sale[5, 4] * (in1[i, 6] - out1[i, 6]))
    Pr2 <- c(Pr2, b)
    c <-
      (out1[i, 8] * sale[7, 3] - in1[i, 8] * sale[7, 2] - sale[5, 4] * (in1[i, 8] - out1[i, 8]))
    Pr3 <- c(Pr3, c)
  }
  dev.new()
  plot(
    x = Pr1,
    col = 'orange',
    type = 'b',
    fg = 'black',
    lwd = 2,
    main = 'Äèíàìèêà ïğèáûëè òîâàğîâ âî âòîğîì ìàãàçèíå',
    xlab = 'Äåíü íåäåëè',
    ylab = 'Ïğèáûëü ïî òîâàğó, ğóá.',
    ylim = c(min(Pr1, Pr2, Pr3), max(Pr1, Pr2, Pr3))
  )
  
  lines(x = Pr2, col = 'green')
  points(x = Pr2, col = 'green', pch = 20)
  
  lines(x = Pr3, col = 'blue')
  points(x = Pr3, col = 'blue', pch = 20)
  
  
  legend(
    'topleft',
    legend = c('Ğàñòâîğèìûé êîôå', 'Ğèñ', 'Ñãóùåíîå ìîëîêî'),
    col = c('orange', 'green', 'blue'),
    pch = 20,
    cex = 0.75,
  )
}

#4.1
{
  dev.new()
  setwd('C:/Users/tkach/Òêà÷åíêî Íèíà/Àíàëèç')
  in1 <-
    read.table("Ìàéîíåç, óï..txt", head = TRUE, encoding = "UTF-8")
  P <- as.integer(in1[1:10, 2])
  barplot(
    height = P,
    names.arg = 1:10,
    main = 'Ïğèáûëü ìàéîíåçà âî âñåõ ìàãàçèíàõ',
    col = 'pink',
    xlab = "Ìàãàçèí",
    ylab = "Âûğó÷êà, ğóá.",
    ylim = c(min(P), max(P))
  )
}
#5
{
  dev.new()
  in1 <-
    read.table("Ìàéîíåç, óï..txt", head = TRUE, encoding = "UTF-8")
  in2 <-
    read.table("Îãóğöû, êã..txt", head = TRUE, encoding = "UTF-8")
  in3 <-
    read.table("Îâñÿíêà, ïà÷åê.txt", head = TRUE, encoding = "UTF-8")
  P1 <- as.integer(in1[1:10, 2])
  P2 <- as.integer(in2[1:10, 2])
  P3 <- as.integer(in3[1:10, 2])
  tabl <- data.frame('¹' = 1:10)
  tabl$"Ìàéîíåç" <- P1
  tabl$"Îãóğöû" <- P2
  tabl$"Îâñÿíêà" <- P3
  P <- as.matrix(tabl[1:10, 2:4])
  Px <- t(P)
  barplot(
    height = Px,
    names.arg = 1:10,
    main = 'Ïğèáûëü âî âñåõ ìàãàçèíàõ ñåòè',
    ylab = 'Ïğèáûëü, ğóá.',
    xlab = "Ìàãàçèí",
    col = c('beige', 'pink', 'purple'),
    beside = TRUE,
    ylim = c(min(P), max(P))
  )
  legend(
    'topleft',
    legend = c('Ìàéîíåç', 'Îãóğöû', 'Îâñÿíêà'),
    col = c('beige', 'pink', 'purple'),
    pch = 20,
    cex = 0.75,
  )
}

#6
{
  dev.new()
  shops = c(1:10)
  data <- data.frame('shop' = shops, 'profit' = tabl[1:10, 4])
  boxplot(
    profit ~ shops,
    data = data,
    main = "Ïğèáûëü îâñÿíêè âî âñåõ ìàãàçèíàõ",
    xlab = "Ìàãàçèí",
    ylab = "Ïğèáûëü, ğóá.",
    col = 'coral'
    
  )
}
